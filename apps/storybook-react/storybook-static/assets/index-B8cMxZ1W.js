const N="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";function W(t){if(!t||typeof t!="string")throw new Error(`Expected base58 string but got “${t}”`);if(t.match(/[IOl0]/gmu))throw new Error(`Invalid base58 character “${t.match(/[IOl0]/gmu)}”`);const e=t.match(/^1+/gmu),n=e?e[0].length:0,o=(t.length-n)*(Math.log(58)/Math.log(256))+1>>>0;return new Uint8Array([...new Uint8Array(n),...t.match(/.{1}/gmu).map(s=>N.indexOf(s)).reduce((s,i)=>(s=s.map(r=>{const c=r*58+i;return i=c>>8,c}),s),new Uint8Array(o)).reverse().filter((s=>i=>s=s||i)(!1))])}var m={};Object.defineProperty(m,"__esModule",{value:!0});var D=m.bech32m=k=m.bech32=void 0;const v="qpzry9x8gf2tvdw0s3jn54khce6mua7l",H={};for(let t=0;t<v.length;t++){const e=v.charAt(t);H[e]=t}function E(t){const e=t>>25;return(t&33554431)<<5^-(e>>0&1)&996825010^-(e>>1&1)&642813549^-(e>>2&1)&513874426^-(e>>3&1)&1027748829^-(e>>4&1)&705979059}function I(t){let e=1;for(let n=0;n<t.length;++n){const o=t.charCodeAt(n);if(o<33||o>126)return"Invalid prefix ("+t+")";e=E(e)^o>>5}e=E(e);for(let n=0;n<t.length;++n){const o=t.charCodeAt(n);e=E(e)^o&31}return e}function C(t,e,n,o){let s=0,i=0;const r=(1<<n)-1,c=[];for(let f=0;f<t.length;++f)for(s=s<<e|t[f],i+=e;i>=n;)i-=n,c.push(s>>i&r);if(o)i>0&&c.push(s<<n-i&r);else{if(i>=e)return"Excess padding";if(s<<n-i&r)return"Non-zero padding"}return c}function G(t){return C(t,8,5,!0)}function L(t){const e=C(t,5,8,!1);if(Array.isArray(e))return e}function j(t){const e=C(t,5,8,!1);if(Array.isArray(e))return e;throw new Error(e)}function O(t){let e;t==="bech32"?e=1:e=734539939;function n(r,c,f){if(f=f||90,r.length+7+c.length>f)throw new TypeError("Exceeds length limit");r=r.toLowerCase();let h=I(r);if(typeof h=="string")throw new Error(h);let l=r+"1";for(let a=0;a<c.length;++a){const x=c[a];if(x>>5)throw new Error("Non 5-bit word");h=E(h)^x,l+=v.charAt(x)}for(let a=0;a<6;++a)h=E(h);h^=e;for(let a=0;a<6;++a){const x=h>>(5-a)*5&31;l+=v.charAt(x)}return l}function o(r,c){if(c=c||90,r.length<8)return r+" too short";if(r.length>c)return"Exceeds length limit";const f=r.toLowerCase(),h=r.toUpperCase();if(r!==f&&r!==h)return"Mixed-case string "+r;r=f;const l=r.lastIndexOf("1");if(l===-1)return"No separator character for "+r;if(l===0)return"Missing prefix for "+r;const a=r.slice(0,l),x=r.slice(l+1);if(x.length<6)return"Data too short";let p=I(a);if(typeof p=="string")return p;const z=[];for(let y=0;y<x.length;++y){const T=x.charAt(y),F=H[T];if(F===void 0)return"Unknown character "+T;p=E(p)^F,!(y+6>=x.length)&&z.push(F)}return p!==e?"Invalid checksum for "+r:{prefix:a,words:z}}function s(r,c){const f=o(r,c);if(typeof f=="object")return f}function i(r,c){const f=o(r,c);if(typeof f=="object")return f;throw new Error(f)}return{decodeUnsafe:s,decode:i,encode:n,toWords:G,fromWordsUnsafe:L,fromWords:j}}var k=m.bech32=O("bech32");D=m.bech32m=O("bech32m");const M=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998];function R(t){return new Y}class Y{constructor(){this.A=1779033703,this.B=-1150833019,this.C=1013904242,this.D=-1521486534,this.E=1359893119,this.F=-1694144372,this.G=528734635,this.H=1541459225,this._size=0,this._sp=0,(!A||_>=8e3)&&(A=new ArrayBuffer(8e3),_=0),this._byte=new Uint8Array(A,_,80),this._word=new Int32Array(A,_,20),_+=80}update(e){if(typeof e=="string")return this._utf8(e);if(e==null)throw new TypeError("Invalid type: "+typeof e);const n=e.byteOffset,o=e.byteLength;let s=o/64|0,i=0;if(s&&!(n&3)&&!(this._size%64)){const c=new Int32Array(e.buffer,n,s*16);for(;s--;)this._int32(c,i>>2),i+=64;this._size+=i}if(e.BYTES_PER_ELEMENT!==1&&e.buffer){const c=new Uint8Array(e.buffer,n+i,o-i);return this._uint8(c)}return i===o?this:this._uint8(e,i)}_uint8(e,n){const{_byte:o,_word:s}=this,i=e.length;for(n=n|0;n<i;){const r=this._size%64;let c=r;for(;n<i&&c<64;)o[c++]=e[n++];c>=64&&this._int32(s),this._size+=c-r}return this}_utf8(e){const{_byte:n,_word:o}=this,s=e.length;let i=this._sp;for(let r=0;r<s;){const c=this._size%64;let f=c;for(;r<s&&f<64;){let h=e.charCodeAt(r++)|0;h<128?n[f++]=h:h<2048?(n[f++]=192|h>>>6,n[f++]=128|h&63):h<55296||h>57343?(n[f++]=224|h>>>12,n[f++]=128|h>>>6&63,n[f++]=128|h&63):i?(h=((i&1023)<<10)+(h&1023)+65536,n[f++]=240|h>>>18,n[f++]=128|h>>>12&63,n[f++]=128|h>>>6&63,n[f++]=128|h&63,i=0):i=h}f>=64&&(this._int32(o),o[0]=o[16]),this._size+=f-c}return this._sp=i,this}_int32(e,n){let{A:o,B:s,C:i,D:r,E:c,F:f,G:h,H:l}=this,a=0;for(n=n|0;a<16;)g[a++]=u(e[n++]);for(a=16;a<64;a++)g[a]=Z(g[a-2])+g[a-7]+X(g[a-15])+g[a-16]|0;for(a=0;a<64;a++){const x=l+Q(c)+K(c,f,h)+M[a]+g[a]|0,p=J(o)+$(o,s,i)|0;l=h,h=f,f=c,c=r+x|0,r=i,i=s,s=o,o=x+p|0}this.A=o+this.A|0,this.B=s+this.B|0,this.C=i+this.C|0,this.D=r+this.D|0,this.E=c+this.E|0,this.F=f+this.F|0,this.G=h+this.G|0,this.H=l+this.H|0}digest(e){const{_byte:n,_word:o}=this;let s=this._size%64|0;for(n[s++]=128;s&3;)n[s++]=0;if(s>>=2,s>14){for(;s<16;)o[s++]=0;s=0,this._int32(o)}for(;s<16;)o[s++]=0;const i=this._size*8,r=(i&4294967295)>>>0,c=(i-r)/4294967296;return c&&(o[14]=u(c)),r&&(o[15]=u(r)),this._int32(o),e==="hex"?this._hex():this._bin()}_hex(){const{A:e,B:n,C:o,D:s,E:i,F:r,G:c,H:f}=this;return w(e)+w(n)+w(o)+w(s)+w(i)+w(r)+w(c)+w(f)}_bin(){const{A:e,B:n,C:o,D:s,E:i,F:r,G:c,H:f,_byte:h,_word:l}=this;return l[0]=u(e),l[1]=u(n),l[2]=u(o),l[3]=u(s),l[4]=u(i),l[5]=u(r),l[6]=u(c),l[7]=u(f),h.slice(0,32)}}const g=new Int32Array(64);let A,_=0;const w=t=>(t+4294967296).toString(16).substr(-8),V=t=>t<<24&4278190080|t<<8&16711680|t>>8&65280|t>>24&255,q=t=>t,u=S()?q:V,K=(t,e,n)=>n^t&(e^n),$=(t,e,n)=>t&e|n&(t|e),J=t=>(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),Q=t=>(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7),X=t=>(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3,Z=t=>(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10;function S(){return new Uint8Array(new Uint16Array([65279]).buffer)[0]===254}const U=t=>R().update(t).digest();var d;(function(t){t.mainnet="mainnet",t.testnet="testnet",t.regtest="regtest",t.signet="signet"})(d||(d={}));var b;(function(t){t.p2pkh="p2pkh",t.p2sh="p2sh",t.p2wpkh="p2wpkh",t.p2wsh="p2wsh",t.p2tr="p2tr"})(b||(b={}));const B={0:{type:b.p2pkh,network:d.mainnet},111:{type:b.p2pkh,network:d.testnet},5:{type:b.p2sh,network:d.mainnet},196:{type:b.p2sh,network:d.testnet}};function tt(t,e){if(!e)return t;if(t===d.mainnet)throw new Error("Cannot cast mainnet to non-mainnet");return e}const P=(t,e)=>({...t,network:tt(t.network,e==null?void 0:e.castTestnetTo)}),et=(t,e)=>{let n;try{t.startsWith("bc1p")||t.startsWith("tb1p")||t.startsWith("bcrt1p")?n=D.decode(t):n=k.decode(t)}catch{throw new Error("Invalid address")}const s={bc:d.mainnet,tb:d.testnet,bcrt:d.regtest}[n.prefix];if(s===void 0)throw new Error("Invalid address");const i=n.words[0];if(i===void 0||i<0||i>16)throw new Error("Invalid address");const r=k.fromWords(n.words.slice(1));let c;return r.length===20?c=b.p2wpkh:i===1?c=b.p2tr:c=b.p2wsh,P({bech32:!0,network:s,address:t,type:c},e)},nt=(t,e)=>{let n;const o=t.slice(0,2).toLowerCase();if(o==="bc"||o==="tb")return et(t,e);try{n=W(t)}catch{throw new Error("Invalid address")}const{length:s}=n;if(s!==25)throw new Error("Invalid address");const i=n[0],r=n.slice(s-4,s),c=n.slice(0,s-4),f=U(U(c)).slice(0,4);if(r.some((a,x)=>a!==f[x]))throw new Error("Invalid address");const h=Object.keys(B).map(Number);if(i===void 0||!h.includes(i))throw new Error("Invalid address");const l=B[i];if(!l)throw new Error("Invalid address");return P({...l,address:t,bech32:!1},e)},rt=(t,e,n)=>{try{const o=nt(t,n);return e?e===o.network:!0}catch{return!1}};export{b as AddressType,d as Network,rt as default,nt as getAddressInfo,rt as validate};
